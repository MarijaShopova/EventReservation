@model IEnumerable<EventReservation.Models.Event>

<h3 class="my-3 text-center">My Events</h3>
<div class="mr-4">
    <p class="float-right">
        @Html.ActionLink("Create New", "Create","Events", null,new { @class = "btn btn-outline-info" })
    </p>
</div>
    <table class="table table-striped text-center container">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Title)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Description)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DateStart)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.TimeStart)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.TimeEnd)
            </th>
            <th>
                <label>Ticket?</label>
            </th>
            <th>
                @Html.DisplayNameFor(model => model.TicketPrice)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NoTables)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ReservedTables)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Performer)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Genre)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.EventImage)
            </th>
            <th></th>
        </tr>

        @foreach (var item in Model)
        {
            <tr id="@item.Id">

                <td>
                    @Html.DisplayFor(modelItem => item.Title)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Description)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.DateStart)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TimeStart)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TimeEnd)
                </td>
                <td>
                    @if (item.HasTicket)
                    {
                        <label>Yes</label>
                    }
                    else
                    {
                        <label>No</label>
                    }
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TicketPrice)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.NoTables)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ReservedTables)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Performer)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Genre)
                </td>
                <td>
                    @if (@item.EventImage == null)
                    {
                        <img src="~/Content/IT_sliki/b52.jpg" style="height: 70px; width: 100px;" class="content-image" />
                    }
                    else
                    {
                        var base64 = Convert.ToBase64String(@item.EventImage);
                        <img src="@string.Format("data:image;base64,{0}", base64)" style="height: 100px; width: 100px;" class="content-image" />

                    }
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", "Events", new { id = item.Id }, new { @class = "btn btn-outline-info btn-sm m-1" })
                    @Html.ActionLink("Details", "Details", "Events", new { id = item.Id }, new { @class = "btn btn-outline-info btn-sm  m-1" })
                    <button type="button" class="btn btn-outline-info btn-sm m-1" onclick="deleteEvent(@item.Id)">Delete</button>
                </td>
            </tr>
        }

    </table>
<script>
    function deleteEvent(id) {
        var formData = new FormData();
        formData.append("id", id);
        $.ajax({
            url: "/Locals/DeleteEvent/",
            type: 'POST',
            data: formData,
            cache: false,
            contentType: false,
            processData: false,
            success: function () {
                $("#" + id).remove();
            },
            error: function () {
                alert("error");
            }
        });
    }
</script>
